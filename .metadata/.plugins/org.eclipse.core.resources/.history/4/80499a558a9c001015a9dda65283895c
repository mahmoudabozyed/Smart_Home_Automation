/*
 * ADC.c
 *
 *  Created on: Sep 24, 2025
 *      Author: VICTUS
 */
#include "GPIO.h"
#include "common_macros.h"
#include <avr/io.h>

void ADC_init(void){
	SET_BIT(ADMUX, REFS0);
	SET_BIT(ADMUX, REFS1);
	SET_BIT(ADCSRA, ADEN);
	SET_BIT(ADCSRA, ADPS0);
	SET_BIT(ADCSRA, ADPS1);
	SET_BIT(ADCSRA, ADPS2);
}

uint16 ADC_readChannel(uint8 channel_num){
	ADMUX &= 0xE0;
	ADMUX |= channel_num;
	SET_BIT(ADCSRA, ADSC);
	while(BIT_IS_SET(ADCSRA, ADIF));
	SET_BIT(ADCSRA, ADIF);
	return ADC;
}
